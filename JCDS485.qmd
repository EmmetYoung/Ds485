---
title: "Ds485"
author: "Emmet"
format: pdf
editor: visual
---

```{r}
library(tidyverse)
library(ggplot2)
library(dplyr)
library(janitor)
```

```{r}
soccer <- read_csv("KPIs.csv") %>% clean_names()
```

```{r}
soccer <- soccer %>% mutate(formation = as.factor(formation))
```

```{r}
soccer <- soccer %>%
drop_na()
```

```{r}
head(soccer)
```

```{r}
ggplot(soccer, aes(x = attacking_clear_cuts , y = jc_goals)) + 
  geom_point() +
    xlab("Chances") +
  ylab("JC Goals") + 
  theme_bw()
```

```{r}
cor(soccer$attacking_clear_cuts, soccer$jc_goals)
```

```{r}
ggplot(soccer, aes(x = opponent_clear_cuts , y = opponent_goals)) + 
  geom_point() +
    xlab("Chances") +
  ylab("Opponent Goals") + 
  theme_bw()
```

```{r}
cor(soccer$opponent_clear_cuts, soccer$opponent_goals)
```

```{r}
ggplot(soccer, aes(x = opponent_clear_cuts , y = opponent_goals, size = massey_ranking)) + 
  geom_point() +
    xlab("Chances") +
  ylab("Opponent Goals") + 
  theme_bw()
```

```{r}
ggplot(soccer, aes(x = opponent_clear_cuts , y = opponent_goals, shape = formation)) + 
  geom_point() +
    xlab("Chances") +
  ylab("Opponent Goals") + 
  theme_bw()
```

```{r}
ggplot(soccer, aes(x = attacking_clear_cuts , y = jc_goals, shape = formation)) + 
  geom_point() +
    xlab("Chances") +
  ylab("JC Goals") + 
  theme_bw()
```

```{r}
ggplot(soccer, aes(x = first_ball_percentage, y = second_ball_percentage)) + 
  geom_point() +
    xlab("First Ball Won Percentage") +
  ylab("Second Ball Won Percentage") + 
  theme_bw()
```

```{r}
cor(soccer$first_ball_percentage, soccer$second_ball_percentage)
```

```{r}
ggplot(data = soccer) + 
  geom_histogram(mapping = aes(x = jc_goals)) + 
  theme_bw() 
```

```{r}
ggplot(data = soccer) + 
  geom_histogram(mapping = aes(x = opponent_goals)) + 
  theme_bw() 
```

```{r}
ggplot(data = soccer) + 
  geom_histogram(mapping = aes(x = opponent_goals, fill = formation)) + 
  theme_bw() 
```

```{r}
ggplot(data = soccer) + 
  geom_histogram(mapping = aes(x = jc_goals, fill = formation)) + 
  theme_bw() 
```

```{r}
ggplot(soccer, aes(x = wide_attacks_total, y = attacking_clear_cuts)) + 
  geom_point() +
    xlab("Wide Attacks") +
  ylab("CLear Cuts") + 
  theme_bw()
```

```{r}
cor(soccer$wide_attacks_total, soccer$attacking_clear_cuts)
```

```{r}
ggplot(soccer, aes(x = wide_attacks_won, y = attacking_clear_cuts)) + 
  geom_point() +
    xlab("Wide Attacks") +
  ylab("CLear Cuts") + 
  theme_bw()
```

```{r}
cor(soccer$wide_attacks_won, soccer$attacking_clear_cuts)
```

```{r}
ggplot(soccer, aes(x = wide_attacks_percentage, y = attacking_clear_cuts)) + 
  geom_point() +
    xlab("Wide Attacks") +
  ylab("Clear Cuts") + 
  theme_bw()
```

```{r}
cor(soccer$wide_attacks_percentage, soccer$attacking_clear_cuts)
```

```{r}
ggplot(data = soccer) + 
  geom_boxplot(mapping = aes(x = opponent_clear_cuts, y = formation)) +
  scale_y_discrete(labels= c("3-5-2", "4-2-3-1")) +
  xlab("Chances Given Up") +
  ylab("Formation") + 
  theme_bw()
```

```{r}
ggplot(data = soccer) + 
  geom_boxplot(mapping = aes(x = attacking_clear_cuts, y = formation)) +
  scale_y_discrete(labels= c("3-5-2", "4-2-3-1")) +
  xlab("Chances Created") +
  ylab("Formation") + 
  theme_bw()
```

```{r}
ggplot(data = soccer) + 
  geom_boxplot(mapping = aes(x = jc_goals, y = formation)) +
  scale_y_discrete(labels= c("3-5-2", "4-2-3-1")) +
  xlab("Goals Scored") +
  ylab("Formation") + 
  theme_bw()
```

```{r}
ggplot(data = soccer) + 
  geom_boxplot(mapping = aes(x = opponent_goals, y = formation)) +
  scale_y_discrete(labels= c("3-5-2", "4-2-3-1")) +
  xlab("Goals Scored") +
  ylab("Formation") + 
  theme_bw()
```

```{r}
ggplot(data = soccer) + 
  geom_boxplot(mapping = aes(x = wide_attacks_total, y = formation)) +
  scale_y_discrete(labels= c("3-5-2", "4-2-3-1")) +
  xlab("Total Wide Attacks") +
  ylab("Formation") + 
  theme_bw()
```

```{r}
ggplot(data = soccer) + 
  geom_boxplot(mapping = aes(x = defensive_wide_attacks_percentage, y = formation)) +
  scale_y_discrete(labels= c("3-5-2", "4-2-3-1")) +
  xlab("Defensive Wide Attack Success Rate") +
  ylab("Formation") + 
  theme_bw()
```

```{r}
ggplot(data = soccer) + 
  geom_boxplot(mapping = aes(x = first_ball_percentage, y = formation)) +
  scale_y_discrete(labels= c("3-5-2", "4-2-3-1")) +
  xlab("First Balls Won Percentage") +
  ylab("Formation") + 
  theme_bw()
```

```{r}
view(soccer)
```

```{r}
ggplot(soccer, aes(x = massey_ranking, y = first_ball_percentage, size = second_ball_percentage)) + 
  geom_point() +
    xlab("Massey Ranking") +
  ylab("First Ball Percentage") + 
  theme_bw()
```

```{r}
ggplot(soccer, aes(x = massey_ranking, y = defensive_wide_attacks_total, size = defensive_wide_attacks_percentage)) + 
  geom_point() +
    xlab("Massey Ranking") +
  ylab("Defensive Wide Attacks Total") + 
  theme_bw()
```

```{r}
soccer$result <- ifelse(soccer$jc_goals > soccer$opponent_goals, "W",
               ifelse(soccer$jc_goals < soccer$opponent_goals, "L", "T"))

view(soccer)
```

```{r}
ggplot(data = soccer) + 
  geom_boxplot(mapping = aes(x = attacking_clear_cuts, y = result)) +
  xlab("First Balls Won Percentage") +
  ylab("Result") + 
  theme_bw()
```

```{r}
ggplot(data = soccer) + 
  geom_boxplot(mapping = aes(x = opponent_clear_cuts, y = result)) +
  xlab("Opponent Clear Cuts") +
  ylab("Result") + 
  theme_bw()
```

```{r}
ggplot(data = soccer) + 
  geom_boxplot(mapping = aes(x = massey_ranking, y = result)) +
  xlab("Massey Ranking") +
  ylab("Result") + 
  theme_bw()
```
